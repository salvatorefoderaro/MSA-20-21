# MSA - 9.03.2021

## Wireless communication

Nelle due lezioni passate abbiamo fatto discorsi introduttivi. Ora cominciamo a trattare gli argomenti di cui ci oppuremo in modo più o meno approfondito. Questo primo set di lezioni che faremo riguardano, dallo schema degli argomenti, problematiche relative alla creazione di una comunicazione che adetta come mezzo trasmissivo un canale wireless. E' bene avere qualche informazione su come parte questa funzione dell'infrastruttura complessiva, che ha caratteristiche particolari di cui è bene essere consapevoli.

Si utilizza una porzione dello spettro elettromagnetico. E' una vista di insieme. Quando si parla di comunicazioni wireless si guarda ad un sottoinsieme di questo spettro. Si va dalle radio frequenze fino al campo del quasi visibile e si va avanti.

Di questa parte dello spettro se ne utilizza un sottoinsieme. Qualunque sia la porzione, hanno delle caratteristiche comuni che iniziano a fare la differenza rispetto alal comunicazione via cavo. Intanto, come avevo già avuto modo di rimarcare, c'è un tasso di errore più elevato in modo notevole, banda disponibile a parità di sviluppo tecnologico inferiore, latenza superiore. Le due porzioni usate sono più o meno visibile, si usa la parte che corrisponde all'infrarosso. Ci sono proposte per realizzare lo spettro visibile, e poi ci sono le radio frequenze. Riguardo l'uso di luce visibile, o quasi, qui si possono trovare tipologie di comunicazioni dirette oppure si possono usare proprietà di riflessione dell'ambietne chiuso in cui ci si trova.

Caratteristica importante di una comunicazione supportata da una radiazione elettromagnetica è che il segnale emesso dalla sorgente si attenua con la distanza, in modo quadratico tipicamente. Questo fa si che allontanandosi da una sorgente che emette segnale basato su una delle due dello spettro esaminato, il tipo di segnale che si propaga si degrada più o meno velocemente. A partire da un certo punto si entra in una zona in cui si è in grado di rilevare la presenza di una comunicazioone che parte da una sorgente, però il segnale si è attenuato al punto tale per cui non è più possibile riuscire a distinguere qual'è l'informazione veicolata da questo segnale. Si sente la presenza dell'emissione di energia ma non si è in grado di decodificare i lsegnale. Il segnale si attenua ancora ed in questa zona non si èiù in grado di capire se c'è o meno una trasmissione in atto da parte della sorgente. Si rileva l'innalzamento del rumore di fondo, del disturbo elettromagnetico che ci circonda in modo più o meno intenso. Allontandosi ancora di più la radiazione scompare. L'ampiezza delle zone dipende dalla potenza del segnale ed anche dalla frequenza usata. Più il segnale è potente, maggiore energia, più lontano arriva il segnale, però usare più potenza significa consumare più energia. Nel contesto in cui ci muoviamo bisogna stare attenti ai consumi energetici. Non è inusuale che chi emette questo segnale sia alimentato da batteria. C'è anche un problema di inquinamento elettromagnetico. Se siamo in zone più o meno abitate, l'energia utilizzata non può superare una certa soglia. 

Nella realtà essendo un segnale che si propaga nello spazio libero, il segnale WiFi è disturbato dalla configurazione dell'ambiente reale. Fenomeni di blocco della comunicazione a secondo del tipo di frequenza usata e del materiale che costituisce l'ostacolo. Può essere deviato passando da un mezzo con densità diversa. Può essere sparpagliato in maniera pulita. Essendo un segnale ondulatorio è soggetto ai fenomeni della propagazione di onde. Tutti problemi che possono influire sulla qualità percepita dai destinatari della comunicazione.

Giusto per dare un'idea visiva di come, a parità di distanza fisica dalla sorgente mittente, la qualità del segnale percepito può cambiare. A parità di distanza, a seconda di dove mi trovo e cosa c'è tra me e la sorgente, posso ricevere un segnale più o meno disturbato.

Questo giusto qualceh dato riguardo vari tipi di tecnologia wireless. Le latenze possono avere più o meno rilevanti, anche variare fortemente.

Riguardo le due porzioni, andando un attimo più in dettaglio, infrarosso, luce visibile verso radiofrequenze, dal punto di vista dei tassi di trasmissione le radiofrequenze permettono di arrivare a tassi di trasmissione un po più elevati. Da un punto di vista economico l'interfaccia di rete dell'infrarosso sono mediamente più economiche. Dal punto di vista della necessità di avere lincenze di accesso, usare radiazioni di tipo infrarosso non richiede nessun tipo di licenza. Per le radiofrequenze dipende. Dal punto di vista delle capacità di espansione nello spazio hanno caratteristiche complementari. Le radiazioni di tipo infrarosso sono confinate all'interno di uno spazio fisico determinati da ostacoli, mentre le radiofrequenze riescono a penetrare anche materiali, a seconda della loro formazione. Queste caratteristiche a seconda delle circostanze possono essere un vantaggio o uno svantaggio.

Saliamo di livello e guardiamo l'infrastruttura fisica che permette di usare questo tipo di mezzo trasmissivo. Sono praticamente due, caratterizzate dalla presenza o meno di elementi infrastrutturali propriamente detti. Una prima tipologia di rete wireless, che forse è quella a cui siamo più abituati per la nostra esperienza, è un'architettura basata sulla presenza di un'infrastruttura, costituita dagli Access Point (AP). L'idea è quella che ogni AP fa da gestore delle comunicazioni wireless in una certa area. Chiunque voglia utilizzare la rete definita da questo AP per interagire con altri, deve comunque usare l'AP come mediatore della comunicazione. Questi pallini verdi sono noti che vogliono comunicare. Anche se i nodi sono uno nella portata dell'altro, nell'architettura basata su infrastruttura la comunicazione deve comunque passare attraverso l'AP. Anche se c'è la capacità fisica di fare arrivare direttamente il segnale, da un punto di vista logico il nodo invia il suo messaggio all'AP, indicando il destinatario finale, e sarà l'AP che reinderizza il messaggio verso il destinatario a livello logico. Questa soluzione ha il vantaggio della semplicità architetturale. Avendo un punto di privilegio, centrale, questo porta con se i vantaggi delle soluzioni centralizzate. Posso concentrare sull'AP buona parte delle funzionalità di gestione del canale, e quindi di conseguenza posso liberare i vari nodi dalla necessità di essere parte attiva preponderante in queste tematiche. C'è una semplificazione costruttiva. Rovescio della medaglia, se l'AP cade nessuno parla più con nessuno. L'AP può fare anche da punto di acecsso per una rete più amplia tipicamente, che succede nelle tipologie che utilizzano questo tipo di architettura. E' un tipo di schema che ritroviamo in varaie tipologie di reti wireless.

L'altra architettura fisica è quella in cui non esiste invece un'ifrastruttura, elementi terzi rispetto ai nodi che di per se vorrebbero comunicare tra di loro. Per ora, parliamo del livello base di questo tipo di architettura in cui quello che immaginiamo è che i nodi per parlare tra di loro devono essere uno nella portata dell'altro. Questo è il livello 0 di questo tipo di architettura. Tra un po, questo livello 0 può essere esteso consentendo ad alcuni di questi la comunicazione che non sono tra la portata diretta tra l'uno e l'altro, consentendo a qualcuno di fare da ponte verso il destinatario finale. Rimanendo nell'ambito di reti basate su un singolo passo, la possibilità che ci sia la comunicazione tra nodi richiede che siano nella portata diretta tra l'uno e l'altro. I vantaggi si ribaltano rispetto alla situazione precedente. Ogni nodo si assume la sua parte di responsabilità nella realizzazione e condivisone del segnale, ma è un asoluzione robsusta in quanto se un nodo viene meno non ha impatto sulla capacità dei nodi restanti. WPAN, reti personali che coprono aree del raggio di una decina di metri al massimo come bluetooth. Poi reti di tipo WLAN, locale, nell'ordine delle centinaia di metri al massimo. Reti a copertura geografica, WWAN, reti cellulari. Dopo le reti satellitari.

Una rete wireless tipicamente si connette all'idea che i nodi che comunicano tramite questo supporto trasmissivo sono nodi mobili. Non è indispensabile che lo siano, si possono immaginare tipologie di reti wifi in cui i nodi non si muovono, ma possiamo vederlo come un caso estremo. La mobilità, guardando dal punto di vista della qualità di un canale wireless, ha un impatto nel breve e lungo termine sulla qualità nel segnale. Nel breve termine, se un nodo si sposta mentre usa un canale wireless, lo spostamento può causare una variazione del canale sottostante e cambiamenti repentini nella potenza ricevuta. Nel lungo termine se ero connesso alla sorgente wireless ed ero connesso a questo posso osservare un decadimento della qualità del segnale, entrando nelle zone di sempre maggiore degradazione del segnale. Da questo punto di vista la mobilità può avere un impatto negativo sulla qualità del segnale percepito.

Saliamo di livello. Modi di utilizzazione del mezzo trasmissivo. Un canale wirelessè u nmezzo trasmissivo condiviso. Si muove a meno di ostacoli nello spazio libero. Tutti i nodi e le entità che coesistono dall'interno della regione sono in grado di utilizzare il mezzo. Bisogna trovare i modi per gestire la condivisione. Ci sono 3 modi diversi, più 1 perché il quarto viene usato in congiunzione con uno dei primi tre, lungo tre dimensioni diverse: frequenze, tempo e codice. Le prime due sono molto intuibili, la terza un po meno familiare. Sono modi di condividere il canale. Dati questi modi, su queste modalità si poggiano i protocolli che realizzano con le proprie regole i meccanismi di condivisione.

Prima possibilità, la condivisione rispetto alla dimensione della frequenza. Immaginiamo di avere riservato una certa porzione dello spettro elettromagnetico per realizzare il mio canale wireless. Questa porzione dello spetro, che mi garantisce una certa banda trasmissiva, viene suddivisa in tante parti. Ogni utilizzatore, ogni entità a cui viene assegnata una di queste porzioni ha la facoltà di usarla per tutto il tempo che ritiene necessario, la può usare come non usare, però godendo di una frazione della banda complessiva disponibile. In questa tipologia di condivisione ogni entità a cui viene assegnato un canale wireless lo può usare per il tempo che vuole ma solo una frazione della capacità complessiva. 

Seconda tecnica è quella della ripartizione rispetto al tempo. L'idea è che in ogni singolo istante di tempo c'è solo un'entità attiva, mentre nel primo caso possono essere tante quante le fasce. Una sola entità per volta, ma in intervalli di tempo diversi può cambiare l'identità di chi utilizza il canale. Gli intervalli non devono essere della stessa lunghezza. La cosa rilevante è che all'interno dell'intervallo la singola entità usa tutta la banda offerta dal canale.

Queste due tipologie possono essere usate in combinazione. Intervalli di tempo diversi, frequenze diverse.

Ultima tecnica, quella meno familiare, è quella lungo la dimensione dei codici. Qui, giusto per dare un'idea intuitiva di come funziona questa tecnica, riferimento sempre preso da un lavoro, immaginate una stanza dove ci siano parlanti di varie lingue. Se un'altra persona che parla italiano entra nella stanza, se il numero di parlanti non supera una certa soglia, anche se c'è una babele di lingue in contemporanea, chi è fluente in una di queste lingue, il suo apparato uditivo è tipicamente ingrado di riuscire a capire qualcosa di ciò che viene detto nell sua lingua. Nello schema tutti trasmettono contemporaneamente, ma a differenza della condivisione in frequenza, tutti trasmettono usando tutto lo spettro di frequenza. Ogni trasmittente in realtà non emette solo il suo segnale ma lo modula, fa un'interpolazione, con un codice particolare, ortogonale rispetto ai codici utilizzato da tutti gli altri. Questo consente in ricezione, se conosco il codice, posso mettere in piedi un filtro che di tutto il segnale che arriva butta via la parte interpolata con codici orrogonali rispetto al mio e riesco a far passare solo la parte di segnale che mi compete. Potrebbe venire il dubbio che questo modo di trasmettere sia il più efficiente di tutti. Le cose non stanno così in quanto uso la banda per tutto il tempo, ma trasmetto quello che voglio trasmettere più il codice, che è informazione di servizio, però occupa banda. Uso tutta la banda, però una parte la "spreco" per rendere possibile la comunicazione ma non per veicolare l'informazione utile.

In congiunzione con queste, per aumentare il grado di parallelismo, quindi le comunicazioni simultanee che si possono realizzare una volta fissata la porzione di spettro a disposizione, queste possono essere moltiplicate aggiungendo la condivisione nello spazio, direttamente collegata ai segnali wireless che hanno la caratteristica di attenuarsi nello spazio (radiofrequenza). Facciamo un esempio in riferimento alla divisione in frequenza. Assumiamo che c'è una certa regione dello spazio, area quadrata. In questa regione ho a disposizione un canale wireless che fa riferimento ad un intervallo di frequenze contigue. Immaginiamo che posso ritenere di ritagliare l'intervallo in due parti. La parte A, metà dell'intervallo disponibile, e la parte B con cui posso realizzare un altro canale, con un'antenna che regola l'uso di queste frequenze. All'interno della regione due entità possono parlare in contemporanea con altre. Per aumentare il numero posso agire concettualmente, la figura non rende nella realtà. Immaginiamo di dividere la regione in tre parti adiacenti. In due di queste parti io utilizzo per comunicare la stessa frequenza. Immaginate che ci siano due nodi che non vogliono parlare tra di loro. Questi utilizzano per parlare con i loro partner l'intervallo A. Cosa cambia? Cambia che la potenza del segnale emesso da queste due potenze è minore rispetto alla potenza della singola antenna. Il segnale si attenua in modo tale che una volta che il segnale arriva all'altra antenna A non è più intellegibile, in quanto non c'è nessuno che rovina il segnale. La cosa vale anche in senso inverso. Due utenti possono usare in parallelo lo stesso intervallo di frequenze purché le due antenne che regolano la realizzazione di questo canale siano a sufficiente distanza da uno all'altro. In mezzo, nell'area B, in questa zona uso la frequenza B, che anche se il segnale emesso dalle altre antenne è rilevabile, si muove su una banda di frequenza diversa dunque le comunicazioni non sono disturbate. Senza cambiare l'intervallo di frequenze usato, da due comunicazioni in simultanea sono passato a tre, diminuendo la potenza del segnale emesso e distanziando in modo appropriato le stazioni che utilizzano la stessa frequenza.

In realtà la partizione segue uno schema più vicino alla figura con celle esagonali, non realmente possibili, anche se in realtà ogni stazione usa una certa gamma di frequenze che viene riusata ad una distanza sufficiente da evitare l'interferenza. Poi la ripartizione del canale complessivo tra le varie aree viene pianificata in base ad idagini sulle densità di uso.

Questi erano le tecniche per realizzare la condivisione. Queste tecniche sono lo strato base su cui si poggiano le definizioni di protocolli di uso. Da questo punto di vista possiamo riconoscere tre famiglie di protocolli diversi: statico, in cui la ripartizione viene definita a priori. Sia che lavori in frequenza, in tempo o in codice, definisco a priori come e tra quanti utenti il canale può essere ripartito; casuali, protocolli basati su contesa in cui non c'è una regola statica basata a priori, ma chi vuole usare il canale deve partecipare ad una gara e tipicamente lavorano nella dimensione del tempo per ripartire il canale; dinamici, dove l'idea è che c'è un gestore centrale a cui i potenziali utilizzatori devono rivolgere la richiesta di usare il canale, magari dando anche informazioni su quelli che sono i requisiti, e sarà questo gestore usando una sua politica di ripartizione di uso del canale, a decidere chi e come potrà usare in maniera dinamica il canale.

Facendo un cofronto, anche qui tagliato con il coltello, rispetto a sprechi di banda causati da potenzialità trasmissive non utilizzate, potenzialità perse a causa di collisioni tra utilizzatori diverse o potenzialità perse a causa di traffico di controllo, tagliando le cose con il coltello si ha la tabella in figura. I protocolli statici hanno spreco di banda in quanto essendo un'assegnazione statica assegno una parte del canale ad un potenziale utilizzatore che ha fatto richiesta dell'uso, ma non è detto che la usi a tempo pieno. Essendo un'assegnazione statica non posso in modo dinamico allocare la porzione di spettro che non viene usata. Nel controllo casuale, chi acquisice il canale lo usa tutto quanto, se ha vinto la contesa aveva qualcosa da trasmettere, quindi non c'è banda sprecata; ci sono collisioni però, con probabilità più o meno alta. Nel controllo dinamico chi usa il canale ha qualcosa da trasmettere, non c'è spreco e non ci sono collisioni, però realizzare il controllo centrale richiede un traffico di controllo per dare e togliere i permessi di accesso più sostenuto rispetto ai casi precedenti.

Due parole sui protocolli statici. Quelli tipicamente usati, nel caso di ripartizione in frequenza l'idea è di prendere la gamma di frequenze e ritagliarla in parti uguali, dove la variabile di controllo è quanto deve essere amplia la banda assegnata ad un utilizzatore con le fette uguali. E' il modo più semplice di condividere un canale wireless. In condivisione di tempo è organizzare l'asse dei tempi come una ripetizione ciclica di n intervalli di pari durata, ed ognuno di questi intervalli viene assegnato ad un utilizzatore che sa quanto dura l'intervallo che gli viene assegnato, e dopo aver atteso N turni, ritorna a trasmettere. Nella condivisione in codice, rispetto alle prime due dove N è rigidamente determinata, la cosa è un po meno rigida. Dopo aver definito gli N codici, N nodi possono trasmettere in parallelo, se arriva l'N+1 gli assegno, se posso, un altro codice ortogonale rispetto ai precedenti e lo aggiungo. Arriva l'N+2 e così via. Non c'è un limite rigido, però questo gioco lo posso estendere un po ma fino ad un certo punto. Se continuo ad aggiungere utilizzatori, aumento il rumore complessivo, per cui se continuo a fare entrare nuovi utenti nessuno capisce più niente. N non è così rigido come nel caso precedente, ma oscilla in un intervallo che non può espandersi in maniera illimitata.

Sui protocolli a contesa, in buona parte li conoscete. C'è da dire solo qualcosa di specifico sull'uso di questi protocolli in un protocollo wireless. Il precursore di questo tipo di protocolli è Aloha, anarchia totale. Ho un canale wireless, chi vuole trasmettere trasmette. Se due o più trasmettono contemporaneamente c'è una collisione. Se i destinatari non ricevono nulla, lo segnalano e la trasmissione verrà ripetuta. La cosa funziona se la densità d'uso del canale è bassa, e si può dimostrare che rispetto alla capacità teorica trasmissiva, al massimo può arrivare a garantire un throughput che è il 18% della capacità teorica. Modello matematico basato su ipotesi che non accandono nella realtà, però cattura l'unica cosa rilevante che non è proprio svincolata dalla realtà.

Questo è il livello 0. Poi uno cerca di migliorare, con il primo miglioramento quello di ridurre il livello di anarchia, non consentendo di iniziare la trasmissione in qualunque istante ma obbligare ad iniziare al trasmissione ad intervalli cadenzati. Questo semplicissimo meccanismo riduce la probabilità di collisione. Nella figura vediamo tre stazioni diverse e tre pacchetti che collidono. L'avere imposto l'avvio a cadenze fisse, due collisioni ma uno si salva e trasmette. Da 0 passo ad una tramissione. Usando un modello analogo al precedente, questo espendiente raddoppia la capacità del canale passando al 36% circa. 

Da qui si passa all'idea che, piuttosto di trasmettere alla cieca, cerco di essere intelligente e prima di trasmettere ascolto il canale e cerco di capire se c'è una tramissione in atto. Se c'è, non trasmetto, evito di trasmettere. Con due varianti possibili: quella di dire che se ho ascoltato il canale libero, mi butto o aspetto? Nella variante CD è che mi butto subito, però mantengo un'orecchio aperto a vedere cosa succede. Se io rilevo che vado in collisione, che sto andando in collisione che assiem a me ha rilevato il canale libero, se io rilevo una collisione mi blocco, evito di occupare il canale per trasmettere tutti questi byte che avevo in attesa di essere immessi nel canale, ed aspetto che il canale ritorni libero. Questa è la tecnica usata dal protocollo 802.3, Ethernet. In situazioni di canale non molto occupato, con un traffico intermittente e sporadico, è una tecnica efficace in quanto evita di ritardare la comunicazione quando il canale è libero.

Se non ritengo di poter fare questa ipotesi, la variante è la CA. Se sento il canale libero aspetto un tempo casuale, che estraggo da un'urna, seguito da tutti. Chi estrae il valore minore entra, gli altri sentono il canale occupato e non trasmettono. Vedremo con qualceh aggiustamente l'idea alla base del protocollo wifi, 802.11. Sempre famiglia dei protocolli 802.

A questo punto entra in gioco la caratteristica distintiva dei canali che stiamo usando. Sono canali wireless, ed il segnale wireless sopratutto se basato su radiofrequenze si attenua con una certa rapidità. Questo comporta problemi. Problema del terminale nascosto. Immaginate uno scenario di questo genere: A e C sono i potenziali trasmettitori. Allora A e C sentono il canale libero inizialmente, nessuno sta trasmettendo, e contemporaneamente iniziano a trasmettere. In CD diremmo che trasmettono simultaneamente, soprono la collisione e si fermano. In un canale wireless potrebbe non succedere in quanto A e C non sono in grado di rilevare la collisione, in quanto se la collocazione di A e C e speculare rispetto al destinatario, il segnale di A arriva al destinatario B ma non a C. La stessa cosa vale per C. Tutti e due continuano a trasmettere anche se in B non può catturare nemmeno un bit. Canale impegnato, nessun altro riesce ad usare, utilizzazione 0. La CD in un ambiente wireless non funziona.

C'è un problema ancora più a monte, lo stesso CS, la rilevazione del canale occupato, può non funzionare nemmeno quella. Lo scenario precedente era che A e C iniziano contemporaneamente. Immaginiamo che uno dei due inizia a trasmettere prima dell'altro. In un contesto di CS chi arriva dopo sente il canale occupato e si astiene, ma se A inizia a trasmettere prima di C, se dinuovo A e C sono disposti in questo modo, della trasmissione di A, C non ne è consapevole. Sente canale libero e da terzo in comodo entra in gioco e distrugge la comunicazione in atto. Il canale continua ad essere occupato ma con utilizzazione zero.

Poi c'è un problema complementare, del terminale esposto. Il punto è che B e C vogliono trasmettere, abbastanza vicini da sentirsi uno con l'altro. Se uno inizia a trasmettere prima dell'altro, l'altro rileva il canale occupato e si astiene con un protocollo CS. Il punto è che in certi scenari, sfruttando a nostro vantaggio quello che sembrava un limite, è vero che B e C si sentono tra di loro e si disturbano, ma se B vuole parlare con A e C vuole parlare con D, dal punto di vista A e D il segnale emesso dall'altra stazione non disturba. Qui c'è una babele di segnale, ma ad A e D arrivano dei segnali ottimi. B e C in questo scenario potrebbero trasmettere in simultanea, ma se adottano uno schema CS uno dei due si blocca e l'utilizzazione complessiva è minore di quello che potrebbe essere.

Questi due problemi si creano solo se il protocollo che si usa è un protocollo a contesa. Se è ad assegnazione statica o polling il problema non c'è. Si crea se invece la situazione è più decentralizzata, dove ognuna prova a fare quello che vuole. Tra l'altro questi problemi emergono in tutta la lora gravità in reti senza infrastruttura, in cui i nodi provano a parlare direttamente tra di loro. In reti con infrastruttura dove la comunicazione è mediata dall'AP, dei due problemi nominati il problema del terminale esposto non esiste. Il problema del terminale nascosto esiste anche nelle reti con infrastruttura ma in misura un po più attenuata. Esiste quando due nodi che stanno diametralmente opposti rispetto all'AP cercano entrambi di parlare con l'AP. A questo punto i due nodi possono andare in collisione con l'AP. Anche l'AP compete con gli altri, però per definizione lui è nella portata di tutti i nodi, quindi non può essere che lui vuole usare il canale o lo sta usando qualcuno non si renda conto che lui lo sta usando. Il problema del terminale nascosto è presente nelle reti con infrastuttura ma in misura minore, soltanto quando a voler parlare sono due nodi ma non l'AP. Il terminale esposto invece non esiste nelle reti con infrastruttura.